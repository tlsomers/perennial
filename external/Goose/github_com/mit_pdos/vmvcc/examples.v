(* autogenerated from github.com/mit-pdos/vmvcc/examples *)
From Perennial.goose_lang Require Import prelude.
From Goose Require github_com.mit_pdos.vmvcc.vmvcc.

From Perennial.goose_lang Require Import ffi.grove_prelude.

Definition hello: val :=
  rec: "hello" "txn" :=
    vmvcc.Txn__Write "txn" #0 #(str"hello");;
    vmvcc.Txn__Read "txn" #0;;
    vmvcc.Txn__Delete "txn" #0;;
    #true.

Definition Hello: val :=
  rec: "Hello" "txno" :=
    let: "body" := (Î»: "txni",
      hello "txni"
      ) in
    vmvcc.Txn__Run "txno" "body";;
    #().

Definition CallHello: val :=
  rec: "CallHello" <> :=
    let: "db" := vmvcc.MkDB #() in
    vmvcc.DB__ActivateGC "db";;
    let: "txn" := vmvcc.DB__NewTxn "db" in
    Hello "txn";;
    #().
